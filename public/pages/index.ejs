<!DOCTYPE html>
<html>

<head>
	<title><%=pageTitle%></title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.4/vue.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.2/axios.min.js"></script>
</head>

<body>
	<div id="app" style="display:none">
		<div>
			Flashcards:
			<hr />
			<div class="dropdown">
				<button type="button" class="btn btn-minimal dropdown-toggle btn-sm" data-toggle="dropdown">
					Category
				</button>
				<div class="dropdown-menu">
					<a class="dropdown-item categoryItem" href="#" @click="switchCategory()"
						v-for="item in categories">{{item}}</a>
				</div>
			</div>
			<hr />

			<div v-show="!pageLoaded">
				<i class="fa fa-spinner fa-pulse page_loading_spinner" aria-hidden="true"></i>
			</div>
			<div class="content" v-show="pageLoaded">
				<div class="flashcard" v-for="item in flashcards">
					<div class="icon"><img src="images/card_back.png" alt="card_back"></div>
					<div class="infoArea">
						<div class="category">{{item.category}}</div>
						<div class="front">{{item.front}}</div>
						<div class="back">{{item.back}}</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script>
		const app = new Vue({
			el: '#app',
			data: {
				flashcards: [],
				pageLoaded: false,
				pageError: false,
				categories: []
			},
			methods: {
				initialize: function () {
					$("#app").fadeIn(500);
					this.loadPageData();
				},
				loadPageData: function () {
					this.pageLoaded = false;
					axios({
						method: 'post',
						url: 'backend',
						data: {
							action: 'loadPageData'
						}
					}).then(response => {
						const data = response.data;
						this.flashcards = data.flashcards;
						this.categories = data.categories;
						this.pageLoaded = true;
					}).catch(function (error) {
						this.pageError = true;
					});
				},
				switchCategory: function () {
					console.log('clicked');
				}
			}
		});
		app.initialize();
	</script>
</body>

</html>